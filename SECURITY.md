# –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ Birthday Bot ## –û–±–∑–æ—Ä —Å–∏—Å—Ç–µ–º—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ Birthday Bot —Ä–µ–∞–ª–∏–∑—É–µ—Ç –º–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤—É—é —Å–∏—Å—Ç–µ–º—É –∑–∞—â–∏—Ç—ã –æ—Ç —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ç–∏–ø–æ–≤ –∞—Ç–∞–∫ –∏ –∑–ª–æ—É–ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–π. ## –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –∑–∞—â–∏—Ç–Ω—ã–µ –º–µ—Ä—ã ### 1. **Rate Limiting (–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —á–∞—Å—Ç–æ—Ç—ã –∑–∞–ø—Ä–æ—Å–æ–≤)** - **–õ–∏–º–∏—Ç:** 10 –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ –º–∏–Ω—É—Ç—É –Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è - **–û–∫–Ω–æ:** 60 —Å–µ–∫—É–Ω–¥ - **–ó–∞—â–∏—Ç–∞ –æ—Ç:** –°–ø–∞–º-–∞—Ç–∞–∫, DoS –∞—Ç–∞–∫ - **–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:** `isRateLimited()` –≤ `index.js` ### 2. **–í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö** - **–î–ª–∏–Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏–π:** –ú–∞–∫—Å–∏–º—É–º 1000 —Å–∏–º–≤–æ–ª–æ–≤ - **–î–ª–∏–Ω–∞ –∏–º–µ–Ω–∏:** –ú–∞–∫—Å–∏–º—É–º 100 —Å–∏–º–≤–æ–ª–æ–≤ - **–î–ª–∏–Ω–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏:** –ú–∞–∫—Å–∏–º—É–º 500 —Å–∏–º–≤–æ–ª–æ–≤ - **–ü–∞—Ç—Ç–µ—Ä–Ω—ã:** –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Å–∏–º–≤–æ–ª—ã - **–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:** `validateMessage()` –≤ `index.js` ### 3. **–°–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö** - **HTML/XML —Å–∏–º–≤–æ–ª—ã:** `< > " ' &` - **Command injection:** `; & | ` $ ( ) { } [ ]` - **Path traversal:** `../` –∏ `..\\` - **–ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–æ–±–µ–ª–æ–≤** - **–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:** `sanitizeText()` –≤ `security.js` ### 4. **–ó–∞—â–∏—Ç–∞ –æ—Ç ReDoS –∞—Ç–∞–∫** - **–ü–æ–≤—Ç–æ—Ä—è—é—â–∏–µ—Å—è —Å–∏–º–≤–æ–ª—ã:** –ú–∞–∫—Å–∏–º—É–º 50 –ø–æ–¥—Ä—è–¥ - **–ü–æ–≤—Ç–æ—Ä—è—é—â–∏–µ—Å—è —Å–ª–æ–≤–∞:** –ú–∞–∫—Å–∏–º—É–º 10 —Ä–∞–∑ - **–≠–º–æ–¥–∑–∏:** –ú–∞–∫—Å–∏–º—É–º 20 –≤ —Å–æ–æ–±—â–µ–Ω–∏–∏ - **–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:** `isSpam()` –≤ `security.js` ### 5. **–ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π** - **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞** –ø—Ä–∏ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–∏ –∞—Ç–∞–∫ - **–†—É—á–Ω–∞—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞** –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º - **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** –≤—Å–µ—Ö –ø–æ–ø—ã—Ç–æ–∫ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π - **–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:** `SecurityUtils` –∫–ª–∞—Å—Å ### 6. **–í–∞–ª–∏–¥–∞—Ü–∏—è callback –¥–∞–Ω–Ω—ã—Ö** - **–†–∞–∑—Ä–µ—à–µ–Ω–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã:** `list`, `edit`, `delete`, etc. - **–ü–∞—Ç—Ç–µ—Ä–Ω—ã ID:** –¢–æ–ª—å–∫–æ —Ü–∏—Ñ—Ä—ã –¥–ª—è `edit_` –∏ `delete_` - **–ó–∞—â–∏—Ç–∞ –æ—Ç:** –ü–æ–¥–¥–µ–ª–∫–∏ callback –¥–∞–Ω–Ω—ã—Ö - **–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:** `validateCallbackData()` –≤ `index.js` ### 7. **–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –Ω–∞ —Ä–µ—Å—É—Ä—Å—ã** - **–ú–∞–∫—Å–∏–º—É–º –¥–Ω–µ–π —Ä–æ–∂–¥–µ–Ω–∏—è:** 100 –Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è - **–ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–∏–º–∏—Ç–æ–≤** –ø–µ—Ä–µ–¥ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ–º –∑–∞–ø–∏—Å–µ–π - **–ó–∞—â–∏—Ç–∞ –æ—Ç:** –ü–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö - **–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:** `MAX_BIRTHDAYS_PER_USER` –∫–æ–Ω—Å—Ç–∞–Ω—Ç–∞ ### 8. **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏** - **–ü–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å:** Rate limit –ø—Ä–µ–≤—ã—à–µ–Ω–∏—è - **–ê—Ç–∞–∫–∏:** XSS, SQL injection, command injection - **–ë–ª–æ–∫–∏—Ä–æ–≤–∫–∏:** –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –∏ —Ä—É—á–Ω—ã–µ - **–î–µ—Ç–∞–ª–∏:** Timestamp, Chat ID, Username, Details - **–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:** `logSecurityEvent()` –≤ `security.js` ## –¢–∏–ø—ã –∑–∞—â–∏—â–∞–µ–º—ã—Ö –∞—Ç–∞–∫ ### **DoS (Denial of Service)** - Rate limiting (10 –∑–∞–ø—Ä–æ—Å–æ–≤/–º–∏–Ω—É—Ç—É) - –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –¥–ª–∏–Ω—ã —Å–æ–æ–±—â–µ–Ω–∏–π - –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∑–∞–ø–∏—Å–µ–π ### **–°–ø–∞–º –∞—Ç–∞–∫–∏** - –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –ø–æ–≤—Ç–æ—Ä—è—é—â–∏—Ö—Å—è —Å–∏–º–≤–æ–ª–æ–≤ - –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –ø–æ–≤—Ç–æ—Ä—è—é—â–∏—Ö—Å—è —Å–ª–æ–≤ - –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —ç–º–æ–¥–∑–∏ ### **XSS (Cross-Site Scripting)** - –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è `<script>` —Ç–µ–≥–æ–≤ - –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è `javascript:` –ø—Ä–æ—Ç–æ–∫–æ–ª–æ–≤ - –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è event handlers (`onclick`, etc.) ### **Command Injection** - –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è `; & | ` $ ( ) { } [ ]` - –°–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏—è –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö ### **Path Traversal** - –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è `../` –∏ `..\\` –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤ ### **ReDoS (Regular Expression Denial of Service)** - –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –ø–æ–≤—Ç–æ—Ä—è—é—â–∏—Ö—Å—è —Å–∏–º–≤–æ–ª–æ–≤ - –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ä–µ–≥—É–ª—è—Ä–Ω—ã–µ –≤—ã—Ä–∞–∂–µ–Ω–∏—è ### **SQL Injection** - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Supabase (–∑–∞—â–∏—â–µ–Ω–Ω–∞—è ORM) - –ü–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã - RPC —Ñ—É–Ω–∫—Ü–∏–∏ –≤–º–µ—Å—Ç–æ –ø—Ä—è–º–æ–≥–æ SQL ## –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ ### **–¢–∏–ø—ã —Å–æ–±—ã—Ç–∏–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏:** - `RATE_LIMIT_EXCEEDED` - –ü—Ä–µ–≤—ã—à–µ–Ω –ª–∏–º–∏—Ç –∑–∞–ø—Ä–æ—Å–æ–≤ - `INVALID_MESSAGE` - –ù–µ–≤–∞–ª–∏–¥–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ - `ATTACK_DETECTED` - –û–±–Ω–∞—Ä—É–∂–µ–Ω–∞ –∞—Ç–∞–∫–∞ - `BLOCKED_USER_ATTEMPT` - –ü–æ–ø—ã—Ç–∫–∞ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è - `BIRTHDAY_LIMIT_EXCEEDED` - –ü—Ä–µ–≤—ã—à–µ–Ω –ª–∏–º–∏—Ç –¥–Ω–µ–π —Ä–æ–∂–¥–µ–Ω–∏—è ### **–§–æ—Ä–º–∞—Ç –ª–æ–≥–æ–≤:** ``` SECURITY EVENT [2024-01-15T10:30:00.000Z] Chat ID: 123456789 Username: @username Event: RATE_LIMIT_EXCEEDED Details: { message: "spam message..." } --- ``` ## ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ ### **–ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏:** ```javascript RATE_LIMIT = 10; // –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ –º–∏–Ω—É—Ç—É RATE_WINDOW = 60 * 1000; // –æ–∫–Ω–æ –≤ –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥–∞—Ö MAX_MESSAGE_LENGTH = 1000; // —Å–∏–º–≤–æ–ª–æ–≤ –≤ —Å–æ–æ–±—â–µ–Ω–∏–∏ MAX_BIRTHDAYS_PER_USER = 100; // –¥–Ω–µ–π —Ä–æ–∂–¥–µ–Ω–∏—è –Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è ``` ### **–ü–∞—Ç—Ç–µ—Ä–Ω—ã –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏:** - XSS: `/<script[^>]*>.*?<\/script>/gi` - JavaScript: `/javascript:/gi` - Event handlers: `/on\w+\s*=/gi` - SQL: `/(\b(SELECT|INSERT|UPDATE|DELETE|DROP|CREATE|ALTER|EXEC|UNION)\b)/gi` - Commands: `/[;&|`$(){}[\]]/g` - Path traversal: `/\.\.\//g` ## üîß –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å—é ### **–ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:** ```javascript this.security.blockUser(chatId, '–ü—Ä–∏—á–∏–Ω–∞ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏'); ``` ### **–†–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:** ```javascript this.security.unblockUser(chatId); ``` ### **–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:** ```javascript if (this.security.isUserBlocked(chatId)) { // –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω } ``` ## –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —É–ª—É—á—à–µ–Ω–∏—é ### **–ö—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è:** 1. **IP-based rate limiting** –¥–ª—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –∑–∞—â–∏—Ç—ã 2. **–ö–∞–ø—á–∞** –¥–ª—è –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π 3. **Whitelist** –¥–ª—è –¥–æ–≤–µ—Ä–µ–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π 4. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏** —á–µ—Ä–µ–∑ –≤–Ω–µ—à–Ω–∏–µ —Å–µ—Ä–≤–∏—Å—ã ### **–î–æ–ª–≥–æ—Å—Ä–æ—á–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è:** 1. **Machine Learning** –¥–ª—è –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –∞–Ω–æ–º–∞–ª–∏–π 2. **Behavioral analysis** –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π 3. **Integration —Å SIEM** —Å–∏—Å—Ç–µ–º–∞–º–∏ 4. **Automated response** –Ω–∞ –∞—Ç–∞–∫–∏ ## –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ —Å –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å—é ### **–ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:** ```bash # –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ TELEGRAM_BOT_TOKEN=your_bot_token SUPABASE_URL=your_supabase_url SUPABASE_ANON_KEY=your_supabase_key # –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ NODE_ENV=production LOG_LEVEL=info SECURITY_MONITORING=true ``` ### **Docker –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:** ```dockerfile # –ó–∞–ø—É—Å–∫ –æ—Ç –Ω–µ–ø—Ä–∏–≤–∏–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è USER node # –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤ RUN ulimit -n 1024 ``` ## üìû –ö–æ–Ω—Ç–∞–∫—Ç—ã –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –ü—Ä–∏ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–∏ —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏: 1. **–ù–ï** —Å–æ–∑–¥–∞–≤–∞–π—Ç–µ –ø—É–±–ª–∏—á–Ω—ã–µ issue 2. –û—Ç–ø—Ä–∞–≤—å—Ç–µ email –Ω–∞: security@yourdomain.com 3. –û–ø–∏—à–∏—Ç–µ —É—è–∑–≤–∏–º–æ—Å—Ç—å –¥–µ—Ç–∞–ª—å–Ω–æ 4. –£–∫–∞–∂–∏—Ç–µ —à–∞–≥–∏ –¥–ª—è –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è --- **–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** 2024-01-15 **–í–µ—Ä—Å–∏—è:** 1.0.0 **–°—Ç–∞—Ç—É—Å:** Production Ready